THREE.DragControls=function(e,t,n){function o(o){o.preventDefault(),u.x=o.clientX/n.width*2-1,u.y=-o.clientY/n.height*2+1,c.setFromCamera(u,e);var r=c.ray;if(s&&h.enabled){var i=s.normal,f=i.dot(r.direction);if(0==f)return;var m=i.dot(d.copy(s.point).sub(r.origin))/f;l.copy(r.direction).multiplyScalar(m).add(r.origin).sub(v);var p,y,b,g,w;return p?(b=!0,g=!1,w=!1):y?(b=!1,g=!0,w=!1):b=g=w=!0,b&&(s.object.position.x=l.x),g&&(s.object.position.y=l.y),w&&(s.object.position.z=l.z),void E("drag",s)}c.setFromCamera(u,e);var R=c.intersectObjects(t);R.length>0?(n.style.cursor="pointer",a=R[0],E("hoveron",a)):(E("hoveroff",a),a=null,n.style.cursor="auto")}function r(o){o.preventDefault(),u.x=o.clientX/n.width*2-1,u.y=-o.clientY/n.height*2+1,c.setFromCamera(u,e);var r=c.intersectObjects(t),i=c.ray,a=i.direction;r.length>0&&((s=r[0]).ray=i,s.normal=a,v.copy(s.point).sub(s.object.position),n.style.cursor="move",E("dragstart",s))}function i(e){e.preventDefault(),s&&(E("dragend",s),s=null),n.style.cursor="auto"}var s,a,c=new THREE.Raycaster,u=new THREE.Vector3,v=new THREE.Vector3,d=new THREE.Vector3,l=new THREE.Vector3;new THREE.Vector3;this.enabled=!1;var f={},h=this;this.on=function(e,t){return f[e]||(f[e]=[]),f[e].push(t),h},this.off=function(e,t){var n=f[e];return n?(n.indexOf(t)>-1&&n.splice(t,1),h):h};var E=function(e,t,n){var o=f[e];if(o&&!n)for(var r=0;r<o.length;r++)o[r](t)};this.setObjects=function(e){t=e instanceof THREE.Scene?e.children:e},this.setObjects(t),this.activate=function(){n.addEventListener("mousemove",o,!1),n.addEventListener("mousedown",r,!1),n.addEventListener("mouseup",i,!1)},this.deactivate=function(){n.removeEventListener("mousemove",o,!1),n.removeEventListener("mousedown",r,!1),n.removeEventListener("mouseup",i,!1)},this.dispose=function(){h.deactivate()},this.activate()};