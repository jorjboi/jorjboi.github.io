THREE.OrthographicTrackballControls=function(e,t){function o(e){!1!==u.enabled&&(window.removeEventListener("keydown",o),v=g,g===m.NONE&&(e.keyCode!==u.keys[m.ROTATE]||u.noRotate?e.keyCode!==u.keys[m.ZOOM]||u.noZoom?e.keyCode!==u.keys[m.PAN]||u.noPan||(g=m.PAN):g=m.ZOOM:g=m.ROTATE))}function n(){!1!==u.enabled&&(g=v,window.addEventListener("keydown",o,!1))}function s(e){!1!==u.enabled&&(e.preventDefault(),e.stopPropagation(),g===m.NONE&&(g=e.button),g!==m.ROTATE||u.noRotate?g!==m.ZOOM||u.noZoom?g!==m.PAN||u.noPan||(R.copy(C(e.pageX,e.pageY)),L.copy(R)):(f.copy(C(e.pageX,e.pageY)),T.copy(f)):(y.copy(z(e.pageX,e.pageY)),w.copy(y)),document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",c,!1),u.dispatchEvent(H))}function i(e){!1!==u.enabled&&(e.preventDefault(),e.stopPropagation(),g!==m.ROTATE||u.noRotate?g!==m.ZOOM||u.noZoom?g!==m.PAN||u.noPan||L.copy(C(e.pageX,e.pageY)):T.copy(C(e.pageX,e.pageY)):w.copy(z(e.pageX,e.pageY)))}function c(e){!1!==u.enabled&&(e.preventDefault(),e.stopPropagation(),g=m.NONE,document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",c),u.dispatchEvent(M))}function a(e){if(!1!==u.enabled){e.preventDefault(),e.stopPropagation();var t=0;e.wheelDelta?t=e.wheelDelta/40:e.detail&&(t=-e.detail/3),f.y+=.01*t,u.dispatchEvent(H),u.dispatchEvent(M)}}function r(e){if(!1!==u.enabled){switch(e.touches.length){case 1:g=m.TOUCH_ROTATE,y.copy(z(e.touches[0].pageX,e.touches[0].pageY)),w.copy(y);break;case 2:g=m.TOUCH_ZOOM_PAN;var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;j=O=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;R.copy(C(n,s)),L.copy(R);break;default:g=m.NONE}u.dispatchEvent(H)}}function h(e){if(!1!==u.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:w.copy(z(e.touches[0].pageX,e.touches[0].pageY));break;case 2:var t=e.touches[0].pageX-e.touches[1].pageX,o=e.touches[0].pageY-e.touches[1].pageY;j=Math.sqrt(t*t+o*o);var n=(e.touches[0].pageX+e.touches[1].pageX)/2,s=(e.touches[0].pageY+e.touches[1].pageY)/2;L.copy(C(n,s));break;default:g=m.NONE}}function p(e){if(!1!==u.enabled){switch(e.touches.length){case 1:w.copy(z(e.touches[0].pageX,e.touches[0].pageY)),y.copy(w);break;case 2:O=j=0;var t=(e.touches[0].pageX+e.touches[1].pageX)/2,o=(e.touches[0].pageY+e.touches[1].pageY)/2;L.copy(C(t,o)),R.copy(L)}g=m.NONE,u.dispatchEvent(M)}}function d(e){e.preventDefault()}var u=this,m={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.radius=0,this.rotateSpeed=1,this.zoomSpeed=1.2,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.noRoll=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.keys=[65,83,68],this.target=new THREE.Vector3;var E=1e-6,l=!0,g=m.NONE,v=m.NONE,b=new THREE.Vector3,y=new THREE.Vector3,w=new THREE.Vector3,f=new THREE.Vector2,T=new THREE.Vector2,O=0,j=0,R=new THREE.Vector2,L=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom;var N={type:"change"},H={type:"start"},M={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}this.radius=.5*Math.min(this.screen.width,this.screen.height),this.left0=this.object.left,this.right0=this.object.right,this.top0=this.object.top,this.bottom0=this.object.bottom},this.handleEvent=function(e){"function"==typeof this[e.type]&&this[e.type](e)};var k,A,P,V,X,Y,C=(k=new THREE.Vector2,function(e,t){return k.set((e-u.screen.left)/u.screen.width,(t-u.screen.top)/u.screen.height),k}),z=function(){var e=new THREE.Vector3,t=new THREE.Vector3,o=new THREE.Vector3;return function(n,s){o.set((n-.5*u.screen.width-u.screen.left)/u.radius,(.5*u.screen.height+u.screen.top-s)/u.radius,0);var i=o.length();return u.noRoll?i<Math.SQRT1_2?o.z=Math.sqrt(1-i*i):o.z=.5/i:i>1?o.normalize():o.z=Math.sqrt(1-i*i),b.copy(u.object.position).sub(u.target),e.copy(u.object.up).setLength(o.y),e.add(t.copy(u.object.up).cross(b).setLength(o.x)),e.add(b.setLength(o.z)),e}}();this.rotateCamera=(A=new THREE.Vector3,P=new THREE.Quaternion,function(){var e=Math.acos(y.dot(w)/y.length()/w.length());e&&(A.crossVectors(y,w).normalize(),e*=u.rotateSpeed,P.setFromAxisAngle(A,-e),b.applyQuaternion(P),u.object.up.applyQuaternion(P),w.applyQuaternion(P),u.staticMoving?y.copy(w):(P.setFromAxisAngle(A,e*(u.dynamicDampingFactor-1)),y.applyQuaternion(P)),l=!0)}),this.zoomCamera=function(){if(g===m.TOUCH_ZOOM_PAN){var e=j/O;O=j,u.object.zoom*=e,l=!0}else{e=1+(T.y-f.y)*u.zoomSpeed;Math.abs(e-1)>E&&e>0&&(u.object.zoom/=e,u.staticMoving?f.copy(T):f.y+=(T.y-f.y)*this.dynamicDampingFactor,l=!0)}},this.panCamera=(V=new THREE.Vector2,X=new THREE.Vector3,Y=new THREE.Vector3,function(){if(V.copy(L).sub(R),V.lengthSq()){var e=(u.object.right-u.object.left)/u.object.zoom,t=(u.object.top-u.object.bottom)/u.object.zoom;V.x*=e,V.y*=t,Y.copy(b).cross(u.object.up).setLength(V.x),Y.add(X.copy(u.object.up).setLength(V.y)),u.object.position.add(Y),u.target.add(Y),u.staticMoving?R.copy(L):R.add(V.subVectors(L,R).multiplyScalar(u.dynamicDampingFactor)),l=!0}}),this.update=function(){b.subVectors(u.object.position,u.target),u.noRotate||u.rotateCamera(),u.noZoom||(u.zoomCamera(),l&&u.object.updateProjectionMatrix()),u.noPan||u.panCamera(),u.object.position.addVectors(u.target,b),u.object.lookAt(u.target),l&&(u.dispatchEvent(N),l=!1)},this.reset=function(){g=m.NONE,v=m.NONE,u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.up.copy(u.up0),b.subVectors(u.object.position,u.target),u.object.left=u.left0,u.object.right=u.right0,u.object.top=u.top0,u.object.bottom=u.bottom0,u.object.lookAt(u.target),u.dispatchEvent(N),l=!1},this.dispose=function(){this.domElement.removeEventListener("contextmenu",d,!1),this.domElement.removeEventListener("mousedown",s,!1),this.domElement.removeEventListener("mousewheel",a,!1),this.domElement.removeEventListener("MozMousePixelScroll",a,!1),this.domElement.removeEventListener("touchstart",r,!1),this.domElement.removeEventListener("touchend",p,!1),this.domElement.removeEventListener("touchmove",h,!1),document.removeEventListener("mousemove",i,!1),document.removeEventListener("mouseup",c,!1),window.removeEventListener("keydown",o,!1),window.removeEventListener("keyup",n,!1)},this.domElement.addEventListener("contextmenu",d,!1),this.domElement.addEventListener("mousedown",s,!1),this.domElement.addEventListener("mousewheel",a,!1),this.domElement.addEventListener("MozMousePixelScroll",a,!1),this.domElement.addEventListener("touchstart",r,!1),this.domElement.addEventListener("touchend",p,!1),this.domElement.addEventListener("touchmove",h,!1),window.addEventListener("keydown",o,!1),window.addEventListener("keyup",n,!1),this.handleResize(),this.update()},THREE.OrthographicTrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrthographicTrackballControls.prototype.constructor=THREE.OrthographicTrackballControls;